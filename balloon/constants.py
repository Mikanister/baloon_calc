"""
Константи для калькулятора аеростатів
"""

# Матеріали оболонки: (щільність кг/м³, допустима напруга Па)
MATERIALS = {
    "HDPE": (950, 20e6),
    "TPU": (1200, 35e6),
    "Mylar": (1400, 100e6),
    "Nylon": (1150, 70e6),
    "PET": (1380, 80e6),
    "Kapton": (1420, 150e6),      # Поліімід, високотемпературний
    "Tedlar": (1200, 50e6),       # PVF, стійкий до УФ
    "LDPE": (920, 15e6),          # Низькощільний поліетилен
    "Polyethylene": (960, 18e6),  # Загальний поліетилен
    "PVC": (1380, 45e6),          # Полівінілхлорид
    "Polyester": (1390, 85e6),   # Поліестер
}

# Фізичні константи (визначаємо спочатку, бо використовуються нижче)
T0 = 273.15  # Кельвіни
GRAVITY = 9.81  # м/с²
GAS_CONSTANT = 287.05  # Дж/(кг·К) - газова стала для повітря
LAPSE_RATE = 0.0065  # К/м
SEA_LEVEL_PRESSURE = 101325  # Па
SEA_LEVEL_AIR_DENSITY = 1.225  # кг/м³

# Щільність газів (кг/м³ при нормальних умовах) - для довідки
GAS_DENSITY_AT_STP = {
    "Гелій": 0.1786,
    "Водень": 0.0899,
    "Гаряче повітря": None,  # Розраховується динамічно
}

# Питомі газові сталі для газів (Дж/(кг·К))
# Для ідеального газу: ρ = P/(R_specific * T)
GAS_SPECIFIC_CONSTANT = {
    "Гелій": 2077.0,      # R/M для гелію (M = 0.004 кг/моль)
    "Водень": 4124.0,     # R/M для водню (M = 0.002 кг/моль)
    "Гаряче повітря": GAS_CONSTANT,  # Така ж як для повітря
}

# Аліас для зручності
GAS_DENSITY = GAS_DENSITY_AT_STP

# ============================================================================
# РЕЄСТР ФОРМ ОБОЛОНКИ - єдине джерело правди для форм
# ============================================================================
# Кожна форма має:
#   - display_name: назва для відображення в UI
#   - code: внутрішній код форми
#   - default_params: словник з дефолтними параметрами
#   - description: опис форми
SHAPES = {
    "sphere": {
        "display_name": "Сфера",
        "code": "sphere",
        "default_params": {},
        "description": "Класична сферична форма"
    },
    "pillow": {
        "display_name": "Подушка/мішок",
        "code": "pillow",
        "default_params": {
            "pillow_len": 3.0,  # м
            "pillow_wid": 2.0,  # м
        },
        "description": "Еліпсоїдна форма з параметрами довжини та ширини"
    },
    "pear": {
        "display_name": "Груша",
        "code": "pear",
        "default_params": {
            "pear_height": 3.0,  # м
            "pear_top_radius": 1.2,  # м - радіус верхньої частини (ширша)
            "pear_bottom_radius": 0.6,  # м - радіус нижньої частини (вужча)
        },
        "description": "Конічна форма з різними радіусами верхньої та нижньої частини"
    },
    "cigar": {
        "display_name": "Сигара",
        "code": "cigar",
        "default_params": {
            "cigar_length": 5.0,  # м
            "cigar_radius": 1.0,  # м
        },
        "description": "Циліндрична форма з параметрами довжини та радіуса"
    }
}

# Налаштування за замовчуванням
DEFAULT_THICKNESS = 35  # мкм
DEFAULT_START_HEIGHT = 0  # м
DEFAULT_WORK_HEIGHT = 1000  # м
DEFAULT_GROUND_TEMP = 15  # °C
DEFAULT_INSIDE_TEMP = 100  # °C
DEFAULT_PAYLOAD = 3  # кг
DEFAULT_GAS_VOLUME = 10  # м³
DEFAULT_SHAPE_TYPE = "Сфера"  # Використовує display_name з SHAPES

# Дефолтні параметри форм
DEFAULT_PILLOW_LEN = SHAPES["pillow"]["default_params"]["pillow_len"]
DEFAULT_PILLOW_WID = SHAPES["pillow"]["default_params"]["pillow_wid"]
DEFAULT_PILLOW_HEIGHT = 1.0  # м (не використовується, але залишено для сумісності)
DEFAULT_PEAR_HEIGHT = SHAPES["pear"]["default_params"]["pear_height"]
DEFAULT_PEAR_TOP_RADIUS = SHAPES["pear"]["default_params"]["pear_top_radius"]
DEFAULT_PEAR_BOTTOM_RADIUS = SHAPES["pear"]["default_params"]["pear_bottom_radius"]
DEFAULT_CIGAR_LENGTH = SHAPES["cigar"]["default_params"]["cigar_length"]
DEFAULT_CIGAR_RADIUS = SHAPES["cigar"]["default_params"]["cigar_radius"]
DEFAULT_EXTRA_MASS = 0.0  # кг - додаткова маса обладнання
DEFAULT_SEAM_FACTOR = 1.05  # множник для площі поверхні через шви (5% додатково)

# Допоміжні функції для роботи з формами
def get_shape_display_names():
    """Повертає список назв форм для відображення в UI"""
    return [shape["display_name"] for shape in SHAPES.values()]

def get_shape_code(display_name: str) -> str:
    """Повертає код форми за назвою для відображення"""
    for code, shape in SHAPES.items():
        if shape["display_name"] == display_name:
            return code
    return "sphere"  # fallback

def get_shape_display_name(code: str) -> str:
    """Повертає назву форми для відображення за кодом"""
    return SHAPES.get(code, SHAPES["sphere"])["display_name"]

def get_shape_default_params(code: str) -> dict:
    """Повертає дефолтні параметри форми"""
    return SHAPES.get(code, SHAPES["sphere"])["default_params"].copy()

# ============================================================================
# КОЕФІЦІЄНТИ ПРОНИКНОСТІ (м²/(с·Па)) для гелію та водню
# ============================================================================
# Джерела та діапазони:
# - Типові значення для полімерів: 1e-16 до 1e-12 м²/(с·Па)
# - Джерела: довідники по полімерних матеріалах, технічні специфікації
# - Примітка: значення можуть варіюватися залежно від товщини, температури,
#   виробничого процесу. Використані середні/типові значення.
#
# Діапазони (орієнтовні):
#   HDPE:     Гелій 0.5-2.0e-13, Водень 1.0-3.0e-13
#   TPU:      Гелій 3.0-7.0e-13, Водень 8.0-12.0e-13
#   Mylar:    Гелій 0.5-2.0e-15, Водень 1.0-3.0e-15 (дуже низька проникність)
#   Nylon:    Гелій 1.0-3.0e-13, Водень 3.0-5.0e-13
#   PET:      Гелій 0.5-2.0e-14, Водень 1.0-3.0e-14
#   Kapton:   Гелій 1.0-10.0e-16, Водень 5.0-15.0e-16 (найнижча проникність)
#   Tedlar:   Гелій 1.0-3.0e-14, Водень 2.0-5.0e-14
#   LDPE:     Гелій 1.0-2.0e-13, Водень 2.0-4.0e-13
#   PVC:      Гелій 2.0-4.0e-14, Водень 5.0-7.0e-14
#   Polyester: Гелій 1.0-2.0e-14, Водень 2.0-4.0e-14
#
# Використані значення (середні з діапазонів):
PERMEABILITY = {
    'HDPE':   {'Гелій': 1.0e-13, 'Водень': 2.0e-13},  # Використано: середнє
    'TPU':    {'Гелій': 5.0e-13, 'Водень': 1.0e-12},  # Використано: середнє-високе
    'Mylar':  {'Гелій': 1.0e-15, 'Водень': 2.0e-15},  # Використано: середнє (дуже низька)
    'Nylon':  {'Гелій': 2.0e-13, 'Водень': 4.0e-13},  # Використано: середнє
    'PET':    {'Гелій': 1.0e-14, 'Водень': 2.0e-14},  # Використано: середнє
    'Kapton': {'Гелій': 5.0e-16, 'Водень': 1.0e-15},  # Використано: середнє (найнижча)
    'Tedlar': {'Гелій': 2.0e-14, 'Водень': 4.0e-14},  # Використано: середнє
    'LDPE':   {'Гелій': 1.5e-13, 'Водень': 3.0e-13},  # Використано: середнє
    'Polyethylene': {'Гелій': 1.2e-13, 'Водень': 2.5e-13},  # Використано: середнє
    'PVC':    {'Гелій': 3.0e-14, 'Водень': 6.0e-14},  # Використано: середнє
    'Polyester': {'Гелій': 1.5e-14, 'Водень': 3.0e-14},  # Використано: середнє
} 